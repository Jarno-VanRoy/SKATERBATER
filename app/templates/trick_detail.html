{% extends 'base.html' %}

{% block title %}{{ user_trick.trick.name }} - SKATERBATER{% endblock %}

{# âœ… Ensure the per-page CSS is loaded regardless of endpoint naming #}
{% block extra_styles %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/pages/trick_detail.css') }}">
{% endblock %}

{% block content %}
<div class="card trick-detail-card">

  <!-- Trick Title -->
  <h1 class="trick-title">
    ğŸ›¹ {{ user_trick.trick.name }}
  </h1>

  <!-- Current Status -->
  <p class="status-display">
    Current Status: <strong>{{ user_trick.status.replace('_', ' ').title() }}</strong>
  </p>

  <!-- Change Status Form -->
  <form method="POST" action="{{ url_for('main.update_status', user_trick_id=user_trick.id) }}" class="status-form">
    <label for="status">Change Status:</label>
    <div class="status-controls">
      <select name="status" id="status">
        <option value="to_learn" {% if user_trick.status == 'to_learn' %}selected{% endif %}>To Learn</option>
        <option value="in_progress" {% if user_trick.status == 'in_progress' %}selected{% endif %}>In Progress</option>
        <option value="mastered" {% if user_trick.status == 'mastered' %}selected{% endif %}>Mastered</option>
      </select>
      <button type="submit" class="btn-primary">Update</button>
    </div>
  </form>

 <!-- Practice Sessions -->
<h2 class="session-header">ğŸ“… Practice Sessions</h2>

{% if user_trick.sessions %}
  <ul class="session-list">
    {% for session in user_trick.sessions|sort(attribute='date', reverse=True) %}
      <li class="session-card">
        <strong>{{ session.date.strftime('%Y-%m-%d') }}</strong><br>
        ğŸ² Tries: {{ session.tries }} | ğŸ¯ Landed: {{ session.landed }}<br>
        ğŸ“ Notes: {{ session.notes or 'â€”' }}
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p class="session-empty">No sessions logged yet.</p>
{% endif %}


  <!-- Log New Session -->
  <h3 class="session-header">â• Log a New Session</h3>

  {% if error %}
    <div class="form-error">
      âš ï¸ {{ error }}
    </div>
  {% endif %}

  <form method="POST" action="{{ url_for('main.log_session', user_trick_id=user_trick.id) }}" class="log-session-form">
    <div class="form-row">
      <div class="form-field">
        <label for="date">ğŸ“… Date:</label>
        <input type="date" name="date" id="date" value="{{ current_date }}">
      </div>
      <div class="form-field">
        <label for="tries">ğŸ² Tries:</label>
        <input type="number" name="tries" id="tries" required min="0">
      </div>
      <div class="form-field">
        <label for="landed">ğŸ¯ Landed:</label>
        <input type="number" name="landed" id="landed" required min="0">
      </div>
    </div>

    <div class="form-group">
      <label for="notes">ğŸ“ Notes:</label>
      <textarea name="notes" id="notes" rows="3"></textarea>
    </div>

    <button type="submit" class="btn-primary">ğŸ’¾ Save Session</button>
  </form>

</div>
{% endblock %}
